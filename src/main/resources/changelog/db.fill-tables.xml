<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext
                   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd
                   http://www.liquibase.org/xml/ns/dbchangelog
                   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

    <changeSet author="lenovo (generated)" id="1509472144114-1">
        <createTable tableName="positions">
            <column autoIncrement="true" name="position_id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="position_name" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-2">
        <createTable tableName="priorities">
            <column autoIncrement="true" name="priority_id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="priority_name" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-3">
        <createTable tableName="project_roles">
            <column autoIncrement="true" name="project_role_id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="project_role_name" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-4">
        <createTable tableName="projects">
            <column autoIncrement="true" name="project_id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="project_country" type="VARCHAR(255)"/>
            <column name="project_name" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-5">
        <createTable tableName="qualifications">
            <column autoIncrement="true" name="qualification_id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="qualification_name" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-6">
        <createTable tableName="roles">
            <column autoIncrement="true" name="role_id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="role_name" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-7">
        <createTable tableName="statuses">
            <column autoIncrement="true" name="status_id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="status_name" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-8">
        <createTable tableName="tasks">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="description" type="LONGTEXT"/>
            <column name="end_date" type="datetime(6)"/>
            <column name="percentage" type="DOUBLE"/>
            <column name="start_date" type="datetime(6)"/>
            <column name="task_name" type="VARCHAR(255)"/>
            <column name="time_spent" type="datetime(6)"/>
            <column name="creator_user_id" type="BIGINT"/>
            <column name="executor_user_id" type="BIGINT"/>
            <column name="project_project_id" type="BIGINT"/>
            <column name="task_priority_priority_id" type="BIGINT"/>
            <column name="task_status_status_id" type="BIGINT"/>
            <column name="task_type_type_id" type="BIGINT"/>
        </createTable>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-9">
        <createTable tableName="types">
            <column autoIncrement="true" name="type_id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="type_name" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-10">
        <createTable tableName="users">
            <column autoIncrement="true" name="user_id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="e_mail" type="VARCHAR(255)"/>
            <column name="enabled" type="TINYINT(4)"/>
            <column name="login" type="VARCHAR(255)"/>
            <column name="password" type="VARCHAR(255)"/>
            <column name="user_name" type="VARCHAR(255)"/>
            <column name="user_surname" type="VARCHAR(255)"/>
            <column name="position_position_id" type="BIGINT"/>
            <column name="project_project_id" type="BIGINT"/>
            <column name="project_role_project_role_id" type="BIGINT"/>
            <column name="qualification_qualification_id" type="BIGINT"/>
            <column name="user_role_role_id" type="BIGINT"/>
        </createTable>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-11">
        <createIndex indexName="FK1txbuwm7iaeju7m0yw5129io5" tableName="tasks">
            <column name="task_priority_priority_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-12">
        <createIndex indexName="FK2lhfsxcxxbn7odacysl07jjxf" tableName="tasks">
            <column name="executor_user_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-13">
        <createIndex indexName="FK45g8qgbd8onnqru6dqd28jvg2" tableName="users">
            <column name="position_position_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-14">
        <createIndex indexName="FK4b56n6r621d3cjw3vvqxc6ien" tableName="tasks">
            <column name="task_type_type_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-15">
        <createIndex indexName="FK76i604w0g03q2mgbcya77xaii" tableName="users">
            <column name="project_role_project_role_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-16">
        <createIndex indexName="FK79jo1tntcfow8r9bobgamf3n0" tableName="users">
            <column name="project_project_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-17">
        <createIndex indexName="FKbjpqawr5fb8qr7qtb5sx86nic" tableName="users">
            <column name="user_role_role_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-18">
        <createIndex indexName="FKigthsww3hccygu9ax5o8of6j4" tableName="tasks">
            <column name="project_project_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-19">
        <createIndex indexName="FKmr19rpmsbd23betc4hsyn7spv" tableName="tasks">
            <column name="task_status_status_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-20">
        <createIndex indexName="FKnb2ma7q9p8210byu0u3een0hj" tableName="tasks">
            <column name="creator_user_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-21">
        <createIndex indexName="FKteiw5vxjuk1mhv4m2fxmuoufi" tableName="users">
            <column name="qualification_qualification_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-22">
        <addForeignKeyConstraint baseColumnNames="task_priority_priority_id" baseTableName="tasks" constraintName="FK1txbuwm7iaeju7m0yw5129io5" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="priority_id" referencedTableName="priorities"/>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-23">
        <addForeignKeyConstraint baseColumnNames="executor_user_id" baseTableName="tasks" constraintName="FK2lhfsxcxxbn7odacysl07jjxf" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="user_id" referencedTableName="users"/>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-24">
        <addForeignKeyConstraint baseColumnNames="position_position_id" baseTableName="users" constraintName="FK45g8qgbd8onnqru6dqd28jvg2" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="position_id" referencedTableName="positions"/>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-25">
        <addForeignKeyConstraint baseColumnNames="task_type_type_id" baseTableName="tasks" constraintName="FK4b56n6r621d3cjw3vvqxc6ien" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="type_id" referencedTableName="types"/>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-26">
        <addForeignKeyConstraint baseColumnNames="project_role_project_role_id" baseTableName="users" constraintName="FK76i604w0g03q2mgbcya77xaii" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="project_role_id" referencedTableName="project_roles"/>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-27">
        <addForeignKeyConstraint baseColumnNames="project_project_id" baseTableName="users" constraintName="FK79jo1tntcfow8r9bobgamf3n0" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="project_id" referencedTableName="projects"/>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-28">
        <addForeignKeyConstraint baseColumnNames="user_role_role_id" baseTableName="users" constraintName="FKbjpqawr5fb8qr7qtb5sx86nic" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="role_id" referencedTableName="roles"/>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-29">
        <addForeignKeyConstraint baseColumnNames="project_project_id" baseTableName="tasks" constraintName="FKigthsww3hccygu9ax5o8of6j4" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="project_id" referencedTableName="projects"/>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-30">
        <addForeignKeyConstraint baseColumnNames="task_status_status_id" baseTableName="tasks" constraintName="FKmr19rpmsbd23betc4hsyn7spv" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="status_id" referencedTableName="statuses"/>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-31">
        <addForeignKeyConstraint baseColumnNames="creator_user_id" baseTableName="tasks" constraintName="FKnb2ma7q9p8210byu0u3een0hj" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="user_id" referencedTableName="users"/>
    </changeSet>
    <changeSet author="lenovo (generated)" id="1509472144114-32">
        <addForeignKeyConstraint baseColumnNames="qualification_qualification_id" baseTableName="users" constraintName="FKteiw5vxjuk1mhv4m2fxmuoufi" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="qualification_id" referencedTableName="qualifications"/>
    </changeSet>


    <changeSet id="insert-into-tables-1" author="lenovo">
        <insert tableName="roles">
            <column name="role_name">ADMIN</column>
        </insert>
        <insert tableName="roles">
            <column name="role_name">USER</column>
        </insert>

        <insert tableName="qualifications">
            <column name="qualification_name">Junior</column>
        </insert>
        <insert tableName="qualifications">
            <column name="qualification_name">Middle</column>
        </insert>
        <insert tableName="qualifications">
            <column name="qualification_name">Senior</column>
        </insert>

        <insert tableName="positions">
            <column name="position_name">Java developer</column>
        </insert>
        <insert tableName="positions">
            <column name="position_name">Front end developer</column>
        </insert>
        <insert tableName="positions">
            <column name="position_name">Tester</column>
        </insert>
        <insert tableName="positions">
            <column name="position_name">Business analyst</column>
        </insert>
        <insert tableName="positions">
            <column name="position_name">Quality assurance</column>
        </insert>
        <insert tableName="positions">
            <column name="position_name">Software engineer</column>
        </insert>

        <insert tableName="project_roles">
            <column name="project_role_name">Project Manager</column>
        </insert>
        <insert tableName="project_roles">
            <column name="project_role_name">Team Lead</column>
        </insert>

        <insert tableName="statuses">
            <column name="status_name">OPEN</column>
        </insert>
        <insert tableName="statuses">
            <column name="status_name">REOPEN</column>
        </insert>
        <insert tableName="statuses">
            <column name="status_name">ON_HOLD</column>
        </insert>
        <insert tableName="statuses">
            <column name="status_name">IN_PROGRESS</column>
        </insert>
        <insert tableName="statuses">
            <column name="status_name">RESOLVED</column>
        </insert>
        <insert tableName="statuses">
            <column name="status_name">CLOSED</column>
        </insert>
        <insert tableName="statuses">
            <column name="status_name">IMPLEMENTED</column>
        </insert>
        <insert tableName="statuses">
            <column name="status_name">READY_FOR_TESTING</column>
        </insert>

        <insert tableName="types">
            <column name="type_name">DEV_TASK</column>
        </insert>
        <insert tableName="types">
            <column name="type_name">DEV_TEST</column>
        </insert>
        <insert tableName="types">
            <column name="type_name">QA_TASK</column>
        </insert>
        <insert tableName="types">
            <column name="type_name">BUG</column>
        </insert>
        <insert tableName="types">
            <column name="type_name">QA_TEST</column>
        </insert>
        <insert tableName="types">
            <column name="type_name">QUESTION</column>
        </insert>
        <insert tableName="types">
            <column name="type_name">DOC</column>
        </insert>
        <insert tableName="types">
            <column name="type_name">BA_TASK</column>
        </insert>


        <insert tableName="priorities">
            <column name="priority_name">LOW</column>
        </insert>
        <insert tableName="priorities">
            <column name="priority_name">NORMAL</column>
        </insert>
        <insert tableName="priorities">
            <column name="priority_name">HIGH</column>
        </insert>
        <insert tableName="priorities">
            <column name="priority_name">CRITICAL</column>
        </insert>
        <insert tableName="priorities">
            <column name="priority_name">MAJOR</column>
        </insert>
        <insert tableName="priorities">
            <column name="priority_name">MINOR</column>
        </insert>
        <insert tableName="priorities">
            <column name="priority_name">FIRE</column>
        </insert>

        <insert tableName="projects">
            <column name="project_id">189784</column>
            <column name="project_country">Belarus</column>
            <column name="project_name">Support the system</column>
        </insert>


        <insert tableName="users">
            <column name="user_id">127497326</column>
            <column name="e_mail">g14.katya@gmail.com</column>
            <column name="login">admin</column>
            <column name="password">$2a$10$B8D0ifMmcnKQus1VafyPpOoTQQII6gxrpGylcMAOsw1KWB4boO9si</column>
            <column name="user_name">Johny</column>
            <column name="user_surname">Depp</column>
            <column name="enabled">1</column>
            <column name="project_project_id"
                    valueComputed="(SELECT project_id FROM projects WHERE project_name = 'Support the system')"/>
            <column name="user_role_role_id" valueComputed="(SELECT role_id FROM roles WHERE role_name = 'ADMIN')"/>
        </insert>

        <insert tableName="users">
            <column name="user_id">174121921</column>
            <column name="e_mail">g14.katya@gmail.com</column>
            <column name="login">user</column>
            <column name="password">$2a$10$p5CnYpFsCUKfmbdFj8gx4.4OzWcAGrwnx/kdoxE/A.h5WjUF0Sapa</column>
            <column name="position_position_id" valueComputed ="(SELECT position_id from positions WHERE position_name = 'Java developer')"/>
            <column name="qualification_qualification_id" valueComputed ="(SELECT qualification_id from qualifications WHERE qualification_name = 'Junior')"/>
            <column name="user_name">Robert</column>
            <column name="user_surname">Dauni</column>
            <column name="enabled">1</column>
            <column name="project_project_id"
                    valueComputed="(SELECT project_id FROM projects WHERE project_name = 'Support the system')"/>
            <column name="user_role_role_id" valueComputed="(SELECT role_id FROM roles WHERE role_name = 'USER')"/>
        </insert>

    </changeSet>
</databaseChangeLog>
